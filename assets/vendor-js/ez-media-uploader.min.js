/**
 * EZ Media Uploader
 * Company: Aazz Tech
 * Develoepr: Syed Galib Ahmed
 * Version: 1.0
 * Initial Release: 24 December, 2019
 * */
(function(){function e(e){var t=document.createElement("div");return I(t,"ezmu__drop-zone-section"),t.innerHTML="<h2>"+e.options.dictionary.label.dropHere+"</h2>",t}function t(e){return"avater"===e.options.uploaderType?n(e):i(e)}function i(e){var t=F("ezmu__media-picker-section ezmu--show"),i=F("ezmu__media-picker-controls"),n=F("ezmu__media-picker-icon-wrap-upload","span"),r=F("ezmu__icon ezmu-icon-upload","span");n.appendChild(r),i.appendChild(n);var l=F("ezmu__media-picker-buttons"),o=F("ezmu__titles-area"),s=F("ezmu__title-1","p",e.options.dictionary.label.dragNDrop),u=F("ezmu__title-3","p",e.options.dictionary.label.or);o.appendChild(s),o.appendChild(u);var d=F("ezmu__upload-button-wrap");return a(d,e),l.appendChild(o),l.appendChild(d),i.appendChild(l),t.appendChild(i),t}function n(e){var t=F("ezmu__media-picker-section ezmu--show"),i=F("ezmu__media-picker-controls"),n=F("ezmu__media-picker-icon-wrap-avater","span"),r=F("ezmu__icon ezmu-icon-avater","span");n.appendChild(r),i.appendChild(n);var l=F("ezmu__media-picker-buttons"),o=F("ezmu__upload-button-wrap");return a(o,e),l.appendChild(o),i.appendChild(l),t.appendChild(i),t}function a(e,t){var i="image/*",n=!0;if(null!==t&&"object"==typeof t){n=t.options.allowMultiple;var a=t.options.allowedFileFormats;i=l(a)}e.innerHTML="";var r=document.createElement("input");r.setAttribute("type","file"),r.setAttribute("id",t.fileInputID),r.setAttribute("class","ezmu__file-input"),r.setAttribute("accept",i),n&&r.setAttribute("multiple","");var o=document.createElement("label");o.setAttribute("for",t.fileInputID),o.setAttribute("class","ezmu__btn ezmu__input-label"),o.innerHTML=t.options.dictionary.label.selectFiles,e.appendChild(r),e.appendChild(o)}function r(){var e="ezmu__file-input",t=document.querySelectorAll(".ezmu__file-input");return t.length&&(e="ezmu__file-input-"+(t.length+1)),e}function l(e){var t="image/*";return Array.isArray(e)&&e.length?(t="",D(e,function(e){var i=t+"image/*, ",n=t+"."+e+", ";t="images"===e?i:n}),t=t.replace(/(,\s?)$/,""),t):t}function o(e){var t=F("ezmu__preview-section"),i=F("ezmu__thumbnail-area"),n=F("ezmu__media-picker-buttons"),a=e.options.dictionary.label.addMore;!e.options.allowMultiple&&e.filesMeta.length&&(a=e.options.dictionary.label.change);var r=F("ezmu__upload-button-wrap"),l=F("ezmu__btn ezmu__input-label ezmu__update-file-btn","label",a);return l.setAttribute("for",e.fileInputID),r.appendChild(l),n.appendChild(r),t.appendChild(i),t.appendChild(n),t}function s(){var e=F("ezmu__status-section");return e}function u(e){var t=F("ezmu__info-section"),i=e.dictionary.info,n=F("ezmu__info-list","ul"),a=0;for(var r in i)if(i[r].show&&(e[r]||i[r].pin)){var l=d(r,e),o=i[r].text.replace(/(__DT__)/g,l),s="ezmu__info-list-item "+r;s=i[r].featured?s+" is-featured":s;var u=F(s,"li",o);n.appendChild(u),a++}return a&&t.appendChild(n),t}function d(e,t){var i=e,n=t[i];if("maxFileSize"===i&&n)return T(1024*n);if("maxTotalFileSize"===i&&n)return T(1024*n);if("allowedFileFormats"===i&&Array.isArray(n)&&n.length){var a="";return D(n,function(e){a+=e+", "}),a.replace(/(, )$/,"")}return n}function m(e){var t=e?"ezmu__loading-section ezmu--show":"ezmu__loading-section",i=F(t),n=F("ezmu__loading-icon","span"),a=F("ezmu__loading-icon-img-bg","span");return n.appendChild(a),i.appendChild(n),i}function h(){var e=document.createElement("div");return I(e,"ezmu__thumbnail-list"),e}function p(e,t){var i=e&&"id"in e?e.id:"",n="ezmu__thumbnail-list-item";"avater"===t.options.uploaderType&&(n+=" ezmu__thumbnail_avater");var a=F(n);a.setAttribute("data-id",i);var r=c(e,t),l=v(e);return a.appendChild(r),a.appendChild(l),a}function c(e,t){var i=document.createElement("div");if(I(i,"ezmu__thumbnail-list-item_front"),t.options.featured&&0===t.index){var n=t.options.dictionary.label.featured,a=F("ezmu__featured_tag","span",n);i.appendChild(a)}var r=f(e);if(t.options.showFileSize&&e&&"fileSizeInText"in e){var l=_(e);i.appendChild(l)}if(t.options.allowSorting){var o=g();i.appendChild(o)}return i.appendChild(r),i}function f(){var e=document.createElement("div");I(e,"ezmu__thumbnail-front-item ezmu__front-item__close");var t=F("ezmu__front-item__close-icon","span"),i=document.createElement("span");return I(i,"ezmu__front-item__close-btn"),t.appendChild(i),e.appendChild(t),e}function _(e){var t=F("ezmu__thumbnail-front-item ezmu__front-item__thumbnail-size"),i=!!("object"==typeof e&&"limitExceeded"in e&&e.limitExceeded),n=i?" has-error":"",a=F("ezmu__front-item__thumbnail-size-text"+n,"span");return null==e?(t.appendChild(a),t):(a.innerHTML="fileSizeInText"in e?e.fileSizeInText:"",t.appendChild(a),t)}function g(){var e=document.createElement("div");I(e,"ezmu__thumbnail-front-item ezmu__front-item__sort-buttons");var t=document.createElement("button");I(t,"ezmu__front-item__sort-button ezmu--sort-down"),t.setAttribute("type","button"),t.innerHTML='<span class="ezmu__front-item__sort-button-skin ezmu--sort-down"></span>';var i=document.createElement("button");return I(i,"ezmu__front-item__sort-button ezmu--sort-up"),i.setAttribute("type","button"),i.innerHTML='<span class="ezmu__front-item__sort-button-skin ezmu--sort-up"></span>',e.appendChild(t),e.appendChild(i),e}function v(e){var t=F("ezmu__thumbnail-list-item_back"),i=y(e);return t.appendChild(i),t}function y(e){var t=F("ezmu__thumbnail-img","img"),i=F("ezmu__thumbnail-img-bg","span");if("object"!=typeof e)return i;var n="type"in e?e.type:"file",a="url"in e?e.url:null,r="blob"in e?e.blob:null,l=n.match(/image/g);if(l){var o=a||o;return o=r||o,t.src=o,t.alt="image",t}return i}function z(e){if(!e)return!1;var t=e.querySelectorAll(".ezmu__old-files-meta"),i=[];if(!t.length)return!1;for(var n=0;n<t.length;n++){var a=t[n],r=a.getAttribute("data-url"),l=a.getAttribute("data-attachment-id"),o=a.getAttribute("data-size"),s=a.getAttribute("data-type");if(r&&r.length){var u={};u.url=r,l&&l.length&&(u.attachmentID=l),o&&o.length&&(u.size=parseInt(o)),s&&s.length&&(u.type=s),i.push(u)}}return i}function b(e,t){if(t.innerHTML="",e.length){I(t,"ezmu--show");var i=F("ezmu_alert ezmu_alert_error");i.innerHTML=e[0].message,t.appendChild(i)}else M(t,"ezmu--show")}function F(e,t,i){e=void 0===e?"":e,t=void 0===t?"div":t,i=void 0===i?"":i;var n=document.createElement(t);return I(n,e),n.innerHTML=i,n}function w(e,t){t=void 0===t?[]:t;var i=!1;if(!Array.isArray(t))return null;if(!t.length)return null;if("object"!=typeof e)return null;if(!("name"in e&&"type"in e))return null;for(var n=e.name,a=n.lastIndexOf("."),r=n.substring(a+1),l=0;l<t.length;l++){var o=t[l],s=e.type.match(/image\//g);if("images"===o&&s){i=!0;break}if(o===r){i=!0;break}}return i}function x(e,t){for(var i=!0,n=0;n<e.length;n++){var a=e[n];if(a.name===t.name){i=!1;break}}return i}function T(e){e=parseFloat(e);var t=e/1024,i=t.toFixed(),n=t.toFixed(2),a=i==n?i:n,r=a+" KB",l=t<1024?null:t/1024,o="";if(l){i=l.toFixed(),n=l.toFixed(2),a=i==n?i:n;o=a+" MB"}var s=l?o:r;return s}function S(e,t,i){for(var n=0;n<e.length;n++)if(e[n][t]==i)return n;return null}function A(e){var t=!1;if("string"==typeof e){var i=e.match(/[^\d]/),n=i?null:parseInt(e);t=!!(n&&n>0),e=t?n:e}return"number"==typeof e&&(e=!(e<1)&&e,t=!!e),!!t&&e}function k(e){e.preventDefault(),e.stopPropagation()}function C(e,t){if(!t)return e;if(t&&"object"!=typeof t)return e;var i;for(i in t)e.hasOwnProperty(i)&&("dictionary"===i||(e[i]=t[i]));return e}function I(e,t){if("object"==typeof e&&"className"in e){var i=e.className.split(" ");-1==i.indexOf(t)&&(e.className+=" "+t,e.className=e.className.trim())}}function M(e,t){if(e){var i=new RegExp(t,"g");e.className=e.className.replace(i,""),e.className=e.className.trim()}}function E(e,t){if(e){var i=new RegExp(t,"g"),n=e.className.match(i);return n}}function D(e,t){for(var i=0;i<e.length;i++)t(e[i],i)}this.EzMediaUploader=function(i){var n={containerID:"ez-media-uploader",oldFiels:null,oldFielsUrl:null,maxFileSize:0,maxTotalFileSize:4096,minFileItems:null,maxFileItems:null,allowedFileFormats:["images"],allowMultiple:!0,featured:!0,allowSorting:!0,showAlerts:!0,showFileSize:!0,showInfo:!0,uploaderType:"files",dictionary:{label:{featured:"Featured",dragNDrop:"Drag & Drop",or:"or",dropHere:"Drop Here",selectFiles:"Select Files",addMore:"Add More",change:"Change"},alert:{maxFileSize:"The maximum limit for a file is __DT__",maxTotalFileSize:"The minimum limit for total file size is  __DT__",minFileItems:"The minimum limit for total file is __DT__",maxFileItems:"The maximum limit for total file is __DT__"},info:{maxFileSize:{text:"The maximum allowed size per file is __DT__",show:!0,featured:!1,pin:!1},maxTotalFileSize:{text:"The maximum total allowed file size is __DT__",show:!0,featured:!1,pin:!1},minFileItems:{text:"The minimum __DT__ files are required",show:!0,featured:!1,pin:!1},maxFileItems:{text:"The maximum __DT__ files are allowed",show:!0,featured:!1,pin:!1},allowedFileFormats:{text:"Allowed file types are __DT__",show:!0,featured:!1,pin:!1}}}};"object"==typeof i&&null!==i&&(this.options=C(n,i)),this.debugLog=[],this.isClean=!0,this.oldFiles=[],this.files=[],this.filesMeta=[],this.isDragging=!1,this.draggingCounter=0,this.container=null,this.uploadButtonContainer=null,this.mediaPickerSection=null,this.previewSection=null,this.thumbnailArea=null,this.statusSection=null,this.infoSection=null,this.loadingSection=null,this.init=function(){var e=this.options.containerID,t=document.getElementById(e);t&&(this.container=t,this.getMarkupOptions(),this.getMarkupDictionary(),this.loadOldFiels(),this.attachElements(),this.updatePreview(),this.attachEventListener())},this.getMarkupOptions=function(){if(!this.container)return null;var e=this.container,t=this,i=[{key:"maxFileSize",dataAttr:"max-file-size",dataType:"int"},{key:"maxTotalFileSize",dataAttr:"max-total-file-size",dataType:"int"},{key:"minFileItems",dataAttr:"min-file-items",dataType:"int"},{key:"maxFileItems",dataAttr:"max-file-items",dataType:"int"},{key:"allowedFileFormats",dataAttr:"type",dataType:"array"},{key:"allowMultiple",dataAttr:"allow-multiple",dataType:"bool"},{key:"showAlerts",dataAttr:"show-alerts",dataType:"bool"},{key:"showFileSize",dataAttr:"show-file-size",dataType:"bool"},{key:"featured",dataAttr:"featured",dataType:"bool"},{key:"allowSorting",dataAttr:"allow-sorting",dataType:"bool"},{key:"showInfo",dataAttr:"show-info",dataType:"bool"},{key:"uploaderType",dataAttr:"uploader-type",dataType:"string"}];D(i,function(i){var n=e.getAttribute("data-"+i.dataAttr),a=!(!n||!n.length);if(a&&"string"===i.dataType&&(t.options[i.key]=n),a&&"int"===i.dataType){var r=parseInt(n);t.options[i.key]=!(r<1)&&r}if(a&&"bool"===i.dataType){r=t.options[i.key];switch(n){case"0":case"false":r=!1;break;case"1":case"true":r=!0}t.options[i.key]=r}if(a&&"array"===i.dataType){var l=n.replace(/,+$/,"").replace(/\s/g,"");r=l.split(",");t.options[i.key]=r}})},this.getMarkupDictionary=function(){if(!this.container)return null;var e=this.container,t=this,i=[{key:"featured",class:"ezmu-dictionary-label-featured"},{key:"dragNDrop",class:"ezmu-dictionary-label-drag-n-drop"},{key:"or",class:"ezmu-dictionary-label-or"},{key:"dropHere",class:"ezmu-dictionary-label-drop-here"},{key:"selectFiles",class:"ezmu-dictionary-label-select-files"},{key:"addMore",class:"ezmu-dictionary-label-add-more"},{key:"change",class:"ezmu-dictionary-label-change"}],n=[{key:"maxFileSize",class:"ezmu-dictionary-alert-max-file-size"},{key:"maxTotalFileSize",class:"ezmu-dictionary-alert-max-total-file-size"},{key:"minFileItems",class:"ezmu-dictionary-alert-min-file-items"},{key:"maxFileItems",class:"ezmu-dictionary-alert-max-file-items"}],a=[{key:"maxFileSize",class:"ezmu-dictionary-info-max-file-size"},{key:"maxTotalFileSize",class:"ezmu-dictionary-info-max-total-file-size"},{key:"minFileItems",class:"ezmu-dictionary-info-min-file-items"},{key:"maxFileItems",class:"ezmu-dictionary-info-max-file-items"},{key:"allowedFileFormats",class:"ezmu-dictionary-info-type"}];D(i,function(i){var n=e.querySelectorAll("."+i.class);if(n&&n.length){var a=n[0].innerHTML.trim();t.options.dictionary.label[i.key]=a}}),D(n,function(i){var n=e.querySelectorAll("."+i.class);if(n&&n.length){var a=n[0].innerHTML.trim();t.options.dictionary.alert[i.key]=a}}),D(a,function(i){var n=e.querySelectorAll("."+i.class);if(n&&n.length){var a=n[0].innerHTML.trim();t.options.dictionary.info[i.key].text=a;var r=n[0].getAttribute("data-show"),l=n[0].getAttribute("data-featured"),o=n[0].getAttribute("data-pin");t.options.dictionary.info[i.key].show="0"!==r&&"false"!==r,t.options.dictionary.info[i.key].featured="1"===l||"true"===l,t.options.dictionary.info[i.key].pin="1"===o||"true"===o}})},this.getTheFiles=function(){if(!this.container)return null;this.isClean=!1;var e=[];return this.filesMeta.length?(D(this.filesMeta,function(t){"file"in t&&e.push(t.file)}),e):e},this.getFilesMeta=function(){if(!this.container)return null;this.isClean=!1;var e=[];return this.filesMeta.length?(D(this.filesMeta,function(t){var i={id:t.id,url:t.url,oldFile:t.oldFile};"attachmentID"in t&&(i.attachmentID=t.attachmentID),"url"in t&&(i.url=t.url),"file"in t&&(i.name=t.name,i.fileSize=t.fileSize,i.fileSizeInText=t.fileSizeInText,i.type=t.type,i.limitExceeded=t.limitExceeded),e.push(i)}),e):e},this.validateFiles=function(){if(!this.container)return null;var e=this,t=this.filesMeta,i=this.options.dictionary.alert,n=[],a=this.options.minFileItems,r=A(a);a=r||a,r&&t.length<a&&n.push({errorKey:"minFileItems",message:i.minFileItems.replace(/(__DT__)/g,a)});var l=this.options.maxFileItems,o=A(l);l=o||l,o&&t.length>l&&n.push({errorKey:"maxFileItems",message:i.maxFileItems.replace(/(__DT__)/g,l)}),D(t,function(t){if("object"==typeof t&&null!==t&&"limitExceeded"in t&&t.limitExceeded){var a=e.options.maxFileSize,r=T(1024*a);n.push({errorKey:"maxFileSize",message:i.maxFileSize.replace(/(__DT__)/g,r)})}});var s=this.options.maxTotalFileSize,u=A(s);if(s=u||s,u){var d=1024*s,m=T(1024*s),h=0;D(t,function(e){"object"==typeof e&&null!==e&&"fileSize"in e&&(h+=e.fileSize)}),h>d&&n.push({errorKey:"maxTotalFileSize",message:i.maxTotalFileSize.replace(/(__DT__)/g,m)})}this.options.showAlerts&&!this.isClean&&b(n,this.statusSection);var p=e.container.querySelectorAll(".ezmu__info-list-item");return p&&p.length&&D(p,function(e){M(e,"has-error")}),!this.isClean&&this.options.showInfo&&n.length&&D(n,function(t){var i=e.container.querySelectorAll(".ezmu__info-list-item."+t.errorKey);i&&i.length&&I(i[0],"has-error")}),!n.length||n},this.hasValidFiles=function(){return this.isClean=!1,!0===this.validateFiles()},this.loadOldFiels=function(){if(!this.container)return null;var e=[];if(this.options.oldFiels&&(e=this.getValidatedPaths(this.options.oldFiels)),z(this.container)&&(e=z(this.container)),e.length){this.isClean=!1;for(var t=0;t<e.length;t++){var i=e[t],n={id:t,url:i.url,oldFile:!0};"attachmentID"in i&&(n.attachmentID=i.attachmentID),"type"in i&&(n.type=i.type),"size"in i&&(n.fileSize=1024*i.size,n.fileSizeInText=T(1024*i.size),this.options.maxFileSize&&i.size>this.options.maxFileSize&&(n.limitExceeded=!0)),this.filesMeta.push(n)}}},this.getValidatedPaths=function(e){if(!this.container)return null;if(!Array.isArray(e))return null;if(!e.length)return null;for(var t=[],i=0;i<e.length;i++){var n=e[i];"object"==typeof n&&("url"in n&&t.push(n))}return t.length?t:null},this.attachElements=function(){if(!this.container)return null;var i=this.container;I(i,"ez-media-uploader"),i.innerHTML="",this.fileInputID=r();var n=e(this),a=m(),l=t(this),d=o(this);i.appendChild(n),i.appendChild(a),i.appendChild(l),i.appendChild(d);var h=i.querySelectorAll(".ezmu__upload-button-wrap"),p=i.querySelectorAll(".ezmu__media-picker-section"),c=i.querySelectorAll(".ezmu__preview-section"),f=i.querySelectorAll(".ezmu__thumbnail-area"),_=i.querySelectorAll(".ezmu__loading-section");if(this.uploadButtonContainer=h?h[0]:null,this.mediaPickerSection=p?p[0]:null,this.previewSection=c?c[0]:null,this.thumbnailArea=f?f[0]:null,this.loadingSection=_?_[0]:null,this.options.showAlerts){var g=s();i.appendChild(g);var v=i.querySelectorAll(".ezmu__status-section");this.statusSection=v?v[0]:null}if(this.options.showInfo){var y=u(this.options);i.appendChild(y);var z=i.querySelectorAll(".ezmu__info-section");this.infoSection=z?z[0]:null}},this.attachEventListener=function(){if(this.layoutIsReady()){var e=this;this.attachFileChangeListener(),this.attachDragNDropListener(),this.container.addEventListener("click",function(t){t.target&&(E(t.target,"ezmu__front-item__close-btn")&&e.removeFile(t),E(t.target,"ezmu__front-item__sort-button")?e.changeOrder(t.target):E(t.target,"ezmu__front-item__sort-button-skin")&&e.changeOrder(t.target.parentElement))})}},this.attachFileChangeListener=function(){if(!this.container)return null;var e=this.container.querySelectorAll("#"+this.fileInputID),t=e?e[0]:null;if(t){var i=this;t.addEventListener("change",function(e){i.isClean=!1;var t=e.target.files;t.length&&i.renderFiles(t)})}},this.attachDragNDropListener=function(){if(!this.container)return null;var e=this,t=this.container,i=["dragenter","dragleave","dragover","drop"],n=function(t){e.draggingCounter<1&&e.draggingCounter++,e.draggingCounter>0&&I(e.container,"highlight")},a=function(t){e.draggingCounter>0&&e.draggingCounter--,e.draggingCounter<1&&M(e.container,"highlight")},r=function(t){var i=t.dataTransfer,n=i.files;e.renderFiles(n)};D(i,function(e){t.addEventListener(e,k,!1)}),D(["dragenter","dragover"],function(i){document.addEventListener(i,function(){I(e.container,"drag-enter")},!1),t.addEventListener(i,n,!1)}),D(["dragleave","drop"],function(i){document.addEventListener(i,function(){M(e.container,"drag-enter")},!1),t.addEventListener(i,a,!1)}),t.addEventListener("drop",r,!1)},this.updateLayout=function(e){if(this.layoutIsReady()){var t=this.mediaPickerSection,i=this.previewSection,n=this.loadingSection;switch(e){case"preview":M(n,"ezmu--show"),M(t,"ezmu--show"),I(i,"ezmu--show");break;case"loading":M(t,"ezmu--show"),I(n,"ezmu--show");break;default:M(n,"ezmu--show"),M(i,"ezmu--show"),I(t,"ezmu--show")}}},this.removeFile=function(e){if(!this.container)return null;this.updateLayout("loading");var t=e.target.parentElement.parentElement.parentElement.parentElement,i=t.getAttribute("data-id"),n=S(this.filesMeta,"id",i);if(null!==n){var a=this.filesMeta[n],r=null;if("name"in a){var l=a.name;r=S(this.files,"name",l)}this.filesMeta.splice(n,1),null!==r?(this.files.splice(r,1),this.updatePreview()):this.updatePreview()}else this.updatePreview()},this.changeOrder=function(e){if(!this.container)return null;var t=this.filesMeta.length;if(!(t<2)){var i=e,n=e.parentElement.parentElement.parentElement,a=n.parentElement,r=a.getAttribute("data-id");if(r||(r=n.getAttribute("data-id")),r){var l,o=S(this.filesMeta,"id",r);if(!(E(i,"ezmu--sort-up")&&(l=o+1,l>t-1)||E(i,"ezmu--sort-down")&&(l=o-1,l<0))){var s=this.filesMeta[o];e=this.filesMeta[l];this.filesMeta[o]=e,this.filesMeta[l]=s,this.updatePreview()}}}},this.renderFiles=function(e){if(!this.container)return null;var t=this;if(!this.options.allowMultiple&&this.filesMeta.length>0&&(this.filesMeta=[],this.files=[]),e.length){this.isClean=!1,this.updateLayout("loading");for(var i=[],n=0;n<e.length;n++){var r=e[n],l=w(r,t.options.allowedFileFormats),o=x(this.filesMeta,r);l&&o&&i.push(r)}if(i.length){var s=this.filesMeta.length,u=i.length,d=0;D(i,function(e,i){var n=new FileReader;n.onloadend=function(){var a={id:s+i,file:e,blob:n.result,name:e.name,type:e.type,url:null,oldFile:!1,fileSize:e.size,fileSizeInText:T(e.size)},r=e.type.match(/image\//g);r&&(a.blob=n.result);var l=t.options.maxFileSize,o=!1;if(l){var m=e.size/1024;o=m>l}a.limitExceeded=o,t.filesMeta.push(a),t.files.push(e),d++,u===d&&setTimeout(function(){t.updatePreview()},200)},n.readAsDataURL(e)}),a(this.uploadButtonContainer,this),this.attachFileChangeListener()}else t.updatePreview()}else this.updateLayout("default")},this.updatePreview=function(){if(this.layoutIsReady()){var e=this,t=this.filesMeta;if(!t.length)return this.updateLayout("default"),void this.validateFiles();if(!this.options.allowMultiple&&this.filesMeta.length){label_txt=this.options.dictionary.label.change;var i=this.container.querySelectorAll(".ezmu__update-file-btn");i[0].innerHTML=label_txt}var n=this.thumbnailArea;n.innerHTML="";var a=h();D(t,function(t,i){var n={index:i,options:e.options},r=p(t,n);a.appendChild(r)}),n.appendChild(a),this.updateLayout("preview"),this.validateFiles()}},this.layoutIsReady=function(){for(var e=this,t=!0,i=["container","mediaPickerSection","previewSection","thumbnailArea","loadingSection"],n=0;n<i.length;n++){var a=i[n];if(!e[a]){t=!1;break}}return t}}})();